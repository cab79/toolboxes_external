<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of nt_demean</title>
  <meta name="keywords" content="nt_demean">
  <meta name="description" content="[y,mn]=nt_demean(x,w) - remove weighted mean over cols">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">NoiseTools</a> &gt; nt_demean.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for NoiseTools&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>nt_demean
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>[y,mn]=nt_demean(x,w) - remove weighted mean over cols</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [x,mn]=nt_demean(x,w) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">[y,mn]=nt_demean(x,w) - remove weighted mean over cols
 
  w is optional

  if w is a vector with fewer samples than size(x,1), it is interpreted as
  a vector of indices to be set to 1, the others being set to 0.

 NoiseTools</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="nt_fold.html" class="code" title="function x=fold(x,epochsize)">nt_fold</a>	y=fold(x,epochsize) - fold 2D to 3D</li><li><a href="nt_greetings.html" class="code" title="function nt_greetings(reset)">nt_greetings</a>	nt_greetings - display message the first time the toolbox is used</li><li><a href="nt_unfold.html" class="code" title="function x=nt_unfold(x)">nt_unfold</a>	y=nt_fold(x) - unfold 3D to 2D</li><li><a href="nt_vecadd.html" class="code" title="function x=nt_vecadd(x,v)">nt_vecadd</a>	y=nt_vecadd(x,v) - add vector to all rows or columns of matrix</li><li><a href="nt_vecmult.html" class="code" title="function x=nt_vecmult(x,v)">nt_vecmult</a>	y=nt_vecmult(x,v) - multiply all rows or columns of matrix by vector</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="nt_cov.html" class="code" title="function [c,tw]=nt_cov(x,shifts,w);">nt_cov</a>	[c,tw]=nt_cov(x,shifts,w) - time shift covariance</li><li><a href="nt_demean2.html" class="code" title="function x=nt_demean2(x,w)">nt_demean2</a>	y=nt_demean2(x,w) - remove mean of each row and page</li><li><a href="nt_detrend.html" class="code" title="function x=ntdetrend(x,order,w,basis)">nt_detrend</a>	y=nt_detrend(x,order,w,basis) - remove polynomial or sinusoidal trend</li><li><a href="nt_find_outliers.html" class="code" title="function w=nt_find_outliers(x,toobig1,toobig2);">nt_find_outliers</a>	w=nt_find_outliers(x,toobig1,toobig2) - find outliers (glitches, etc.).</li><li><a href="nt_kurtosis.html" class="code" title="function [todss,K]=nt_kurtosis(x,nIterations,exponent,w,smooth)">nt_kurtosis</a>	[todss,K]=nt_kurtosis(x,nIterations,exponent,w,smooth)- find high-kurtosis components</li><li><a href="nt_repeatability.html" class="code" title="function score=nt_repeatability(x,demean_flag)">nt_repeatability</a>	[score]=nt_repeatability(x,demean_flag) - repeatability score</li><li><a href="nt_sgram.html" class="code" title="function [s,f,t]=nt_sgram(x,window,noverlap,nfft,sr,flags)">nt_sgram</a>	[s,f,t]=nt_sgram(x,window,noverlap,nfft,sr,flags) - spectrogram</li><li><a href="nt_sns.html" class="code" title="function y=nt_sns(x,nneighbors,skip,w)">nt_sns</a>	y=nt_sns(x,nneigbors,skip,w) - sensor noise suppression</li><li><a href="nt_split.html" class="code" title="function [idx,score_vector,score]=nt_split(x,depth,thresh,guard)">nt_split</a>	[idx,score_vector,score]=nt_split(x,depth,thresh,guard) - split time series into intervals</li><li><a href="nt_split_jd.html" class="code" title="function [idx,score_vector,todss]=nt_split_jd(x,thresh,depth);">nt_split_jd</a>	[idx,score_vector,todss]=nt_split_dss(x,thresh,depth) - segmentation based on joint diagonalization</li><li><a href="nt_star.html" class="code" title="function [x,w,ww]=nt_star(x,thresh,closest,depth)">nt_star</a>	[y,w,ww]=nt_star(x,thresh,closest,depth) - sensor noise suppression, new version</li><li><a href="nt_tsr.html" class="code" title="function [y,idx,w]=nt_tsr(x,ref,shifts,wx,wref,keep,thresh)">nt_tsr</a>	[y,idx,w]=nt_tsr(x,ref,shifts,wx,wref,keep,thresh) - time-shift regression (TSPCA)</li><li><a href="nt_tsregress.html" class="code" title="function [z,idx]=nt_tsregress(x,y,shifts,xw,yw,keep,threshold)">nt_tsregress</a>	[z,idx]=nt_tsregress(x,y,shifts,xw,yw,keep,threshold) - time-shift regression</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [x,mn]=nt_demean(x,w)</a>
0002 <span class="comment">%[y,mn]=nt_demean(x,w) - remove weighted mean over cols</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%  w is optional</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%  if w is a vector with fewer samples than size(x,1), it is interpreted as</span>
0007 <span class="comment">%  a vector of indices to be set to 1, the others being set to 0.</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% NoiseTools</span>
0010 
0011 <span class="keyword">if</span> nargin&lt;2; w=[]; <span class="keyword">end</span>
0012 <span class="keyword">if</span> nargin&lt;1; error(<span class="string">'!'</span>);<span class="keyword">end</span>
0013 <a href="nt_greetings.html" class="code" title="function nt_greetings(reset)">nt_greetings</a>;
0014 
0015 <span class="keyword">if</span> ~isempty(w) &amp;&amp; numel(w)&lt;size(x,1)
0016     w=w(:);
0017     <span class="comment">% interpret w as array of indices to set to 1</span>
0018     <span class="keyword">if</span> min(w)&lt;1 || max(w)&gt;size(x,1); 
0019         error(<span class="string">'w interpreted as indices but values are out of range'</span>);
0020     <span class="keyword">end</span>
0021     ww=zeros(size(x,1),1);
0022     ww(w)=1;
0023     w=ww;
0024 <span class="keyword">end</span>
0025 
0026 
0027 <span class="keyword">if</span> size(w,3)~=size(x,3);
0028     <span class="keyword">if</span> size(w,3)==1 &amp;&amp; size(x,3)~=1;
0029         w=repmat(w,[1,1,size(x,3)]);
0030     <span class="keyword">else</span>
0031         error(<span class="string">'W should have same npages as X, or else 1'</span>);
0032     <span class="keyword">end</span>
0033 <span class="keyword">end</span>
0034 
0035 [m,n,o]=size(x);
0036 x=<a href="nt_unfold.html" class="code" title="function x=nt_unfold(x)">nt_unfold</a>(x);
0037 
0038 <span class="keyword">if</span> isempty(w);
0039     
0040     mn=mean(double(x),1);
0041     x=<a href="nt_vecadd.html" class="code" title="function x=nt_vecadd(x,v)">nt_vecadd</a>(x,-mn);
0042     
0043 <span class="keyword">else</span>
0044     
0045     w=<a href="nt_unfold.html" class="code" title="function x=nt_unfold(x)">nt_unfold</a>(w);
0046     
0047     <span class="keyword">if</span> size(w,1)~=size(x,1)
0048         error(<span class="string">'X and W should have same nrows'</span>); 
0049     <span class="keyword">end</span>
0050     
0051     
0052     <span class="keyword">if</span> size(w,2)==1;
0053         mn=sum(<a href="nt_vecmult.html" class="code" title="function x=nt_vecmult(x,v)">nt_vecmult</a>(double(x),w),1) ./ (sum(w,1)+eps);
0054     <span class="keyword">elseif</span> size(w,2)==n;
0055         mn=sum(x.*w) ./ (sum(w,1)+eps);
0056     <span class="keyword">else</span>
0057         error(<span class="string">'W should have same ncols as X, or else 1'</span>);
0058     <span class="keyword">end</span>
0059 
0060     <span class="comment">%y=bsxfun(@minus,x,mn);</span>
0061     x=<a href="nt_vecadd.html" class="code" title="function x=nt_vecadd(x,v)">nt_vecadd</a>(x,-mn);
0062     
0063 <span class="keyword">end</span>
0064 
0065 x=<a href="nt_fold.html" class="code" title="function x=fold(x,epochsize)">nt_fold</a>(x,m);</pre></div>
<hr><address>Generated on Mon 21-Mar-2016 10:28:43 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>